---
import BaseLayout from './BaseLayout.astro';
import GrowthBadge from '../components/GrowthBadge.astro';
import type { CollectionEntry } from 'astro:content';

interface Props {
  entry:
    | CollectionEntry<'notes'>
    | CollectionEntry<'projects'>
    | CollectionEntry<'journals'>
    | CollectionEntry<'photography'>
    | CollectionEntry<'collections'>;
}

const { entry } = Astro.props;
const { title, created, updated, growth } = entry.data;

const formattedCreated = created.toLocaleDateString('en-US', {
  year: 'numeric',
  month: 'long',
  day: 'numeric',
});

const formattedUpdated = updated.toLocaleDateString('en-US', {
  year: 'numeric',
  month: 'long',
  day: 'numeric',
});

const showUpdated = created.getTime() !== updated.getTime();
---

<BaseLayout title={title}>
  <article class="content">
    <header class="content-header">
      <h1>{title}</h1>

      <div class="content-meta">
        <GrowthBadge growth={growth} />

        <div class="content-dates">
          <time datetime={created.toISOString()}>
            <span class="text-muted">Planted:</span>
            {formattedCreated}
          </time>
          {
            showUpdated && (
              <time datetime={updated.toISOString()}>
                <span class="text-muted">Last tended:</span>
                {formattedUpdated}
              </time>
            )
          }
        </div>
      </div>
    </header>

    <div class="content-body">
      <slot />
    </div>
  </article>
</BaseLayout>

<style>
  .content {
    max-width: var(--measure-wide);
  }

  .content-header {
    margin-bottom: var(--space-8);
    padding-bottom: var(--space-6);
    border-bottom: 1px solid var(--color-border);
  }

  .content-header h1 {
    margin-top: 0;
    margin-bottom: var(--space-5);
  }

  .content-meta {
    display: flex;
    flex-direction: column;
    align-items: flex-start;
    gap: var(--space-3);
    font-size: var(--text-sm);
  }

  .content-dates {
    display: flex;
    flex-wrap: wrap;
    gap: var(--space-4);
  }

  .content-project {
    display: flex;
    align-items: center;
    gap: var(--space-2);
  }

  .project-link {
    display: inline-block;
    padding: var(--space-1) var(--space-2);
    background-color: var(--color-surface);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-md);
    font-size: var(--text-xs);
    transition: background-color var(--transition-base),
      border-color var(--transition-base);
  }

  .project-link:hover {
    background-color: var(--color-accent);
    border-color: var(--color-accent);
    color: white;
  }

  .content-topics {
    display: flex;
    align-items: center;
    gap: var(--space-2);
  }

  .topic-list {
    display: flex;
    flex-wrap: wrap;
    gap: var(--space-2);
    list-style: none;
    margin: 0;
    padding: 0;
  }

  .topic-list li {
    margin: 0;
  }

  .topic-list a {
    display: inline-block;
    padding: var(--space-1) var(--space-2);
    background-color: var(--color-surface);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-md);
    font-size: var(--text-xs);
    transition: background-color var(--transition-base),
      border-color var(--transition-base);
  }

  .topic-list a:hover {
    background-color: var(--color-accent);
    border-color: var(--color-accent);
    color: white;
  }

  .content-body {
    margin-top: var(--space-8);
  }

  /* First element in content shouldn't have top margin */
  .content-body > :first-child {
    margin-top: 0;
  }
</style>
